---
title: "Class 9: Structural Bioinformatics pt. 1"
author: "Shazreh Hassan (PID: A13743949)"
format: pdf
---

The main repository for biomolecular structure data is the Protein Data Bank (PDB) https://www.rcsb.org

Let's have a quick look at the composition of this database:

```{r}
stats <- read.csv("Data Export Summary.csv")
head(stats)
```


>Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

```{r}
#first convert characters to integers
as.numeric(sub(",", "", stats$X.ray))

```

This is annoying let's try a different import function from the **readr** package.

```{r}
library(readr)

stats <- read_csv("Data Export Summary.csv")
```
If you don't want to load the whole package, you can use `readr::read_csv()`

```{r}
#percent X-ray
n.total <- sum(stats$Total)
n.xray <- sum(stats$`X-ray`)

round(n.xray/n.total * 100, 2)
```
```{r}
#percent EM
n.EM <- sum(stats$EM)

round(n.EM/n.total * 100, 2)
```


>Q2: What proportion of structures in the PDB are protein only?

```{r}
n.protein <- stats[1, "Total"]

round(n.protein/n.total *100, 2)
```
>Q3. Make a bar plot overview of Molecular type composition using ggplot

```{r}
library(ggplot2)

ggplot(stats)+
  aes(reorder(`Molecular Type`, Total), Total)+
  geom_col()+
  labs(title="PDB Database Composition Oct 2025") +
  theme(plot.title = element_text(hjust=0.5)) +
  xlab(NULL) + 
  ylab("Number of Structures")
```


## visualizing structure data

The Mol* viewer is embedded in many bioninformatics websites. The homepage is https://molstar.org

I can insert any figure or image file using markdown format

![The HIV-Pr dimer with bound inhibitor](1HSG.png)

![catalytic binding site with Asp and a water molecule](1HSG_Asp.png)

## Bio3D package for structural bioinformatics

We can use the bio3d package to read and analyze biomolecular data in R:

```{r}
library(bio3d)

hiv <-  read.pdb("1hsg")
hiv
```

```{r}
head(hiv$atom)
```

Let's get the sequence:

```{r}
pdbseq(hiv)
```

Let's trim to Chain A and get just its sequence:

```{r}
chainA <- trim.pdb(hiv, chain="A")
chainA.seq <-  pdbseq(chainA)
```

Let's blast:

```{r, cache=TRUE}
blast <-  blast.pdb(chainA.seq)
```

```{r}
head(blast$hit.tbl)
```

Plot  a quick overview of blast results

```{r}
hits <-  plot(blast)
```

```{r}
#just the accession numbers of the hits we got
hits$pdb.id
```


## Prediction of functional motions

We can run a Normal Mode Analysis (NMA) to predict large scale motions/flexibility/dynamics of any biomolecule that we can read into R.

Let's look at ADK and chain A only:

```{r}
adk <- read.pdb("1ake")

adk_A <-  trim.pdb(adk, chain="A")
adk_A
```

```{r}
m <- nma(adk_A)
plot(m)
```


Let's write out a "trajectory" of predicted motion

```{r}
#also  saving trajectory as a file
mktrj(m, file="adk_nma.pdb")
```


## Play with 3D viewing in R

We can use the new **bio3dview** package, which is not yet on CRAN, to render interactive 3D views in Rand HTML quarto output reports.

To install from Github, we can use the **pak** package.




